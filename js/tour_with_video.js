$(function(){var tour_with_video={animation_time:125,is_video_shown:false,init:function(){this.$top=$('.top:not(".persistent")');this.$video_container=$(".video_header");this.$watch_the_tour=$("#watch_the_tour");this.stored_offset=0;this.video=this.$watch_the_tour[0].wistiaApi;this.$hero_image_overlay=$(".hero_image_overlay");this.container_height=this.$hero_image_overlay.height();this.$close_video=$(".close_video");this.$tour_btn=$(".tour_btn");this.subscribeHandlers();this.$watch_the_tour.css("display","block")},subscribeHandlers:function(){var self=this;this.$video_container.on("click",".hero_image_overlay",function(){self.video.play()});this.video.bind("play",function(){self.showVideo();self.video.unbind("heightchange");self.$hero_image_overlay.removeClass("no_events")});this.video.bind("end",function(){self.hideVideo()});this.video.bind("pause",function(){if(self.isMobileLandscape()){self.hideVideo()}});this.video.bind("heightchange",function(){if(self.isMobileLandscape()){self.video.height(self.container_height)}});this.$close_video.on("click",function(){self.video.pause();self.hideVideo()});$("body").on("keydown",function(e){if(e.which===27){self.video.pause();self.hideVideo()}})},showVideo:function(){if(!this.is_video_shown){var self=this;this.is_video_shown=true;this.$watch_the_tour.removeClass("stealth");this.$hero_image_overlay.addClass("stealth no_pointer_events");this.$top.addClass("hidden");this.$tour_btn.addClass("stealth hidden");this.$video_container.css("height",this.video.height());this.$close_video.removeClass("hidden");self.stored_offset=$(document).scrollTop();var container_top=self.$video_container.offset().top+1;$("html, body").animate({scrollTop:container_top},200);setTimeout(function(){self.$close_video.addClass("show")},0);setTimeout(function(){self.$video_container.css("height","auto");self.$video_container.addClass("no_transition")},this.animation_time)}},hideVideo:function(){if(this.is_video_shown){var self=this;this.$video_container.css("height",this.video.height());this.$top.removeClass("hidden").addClass("stealth");this.$tour_btn.removeClass("hidden");this.$top.removeClass("hidden").addClass("stealth");setTimeout(function(){self.$top.removeClass("stealth");self.$tour_btn.removeClass("stealth");self.$close_video.removeClass("show");self.$video_container.css("height",self.container_height);self.$hero_image_overlay.css("height",self.container_height);self.$video_container.removeClass("no_transition");$("html, body").animate({scrollTop:self.stored_offset},200)},0);setTimeout(function(){self.$hero_image_overlay.removeClass("stealth no_pointer_events");self.$watch_the_tour.addClass("stealth");self.$close_video.addClass("hidden");self.is_video_shown=false},this.animation_time)}},isMobileLandscape:function(){return window.matchMedia&&window.matchMedia("screen and (max-width: 640px)").matches}};tour_with_video.init();window.tour_with_video=tour_with_video});
